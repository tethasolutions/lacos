<div class="d-flex align-items-center gap-3 mb-2">
    <h3>
        Attività {{activity.number}} &bull; {{activity.status | activityStatus}}
    </h3>
    <div class="d-flex gap-1">
        <a class="btn btn-primary btn-sm" (click)="edit()">
            <span class="fa fa-edit"></span>
            Modifica attività
        </a>
    </div>
</div>

<div class="row mb-4 border-green">
    <div class="col-2">
        <b>
            Commessa
        </b>
        <p>
            {{activity.job}}
        </p>
    </div>
    <div class="col-3">
        <b>
            Cliente
        </b>
        <p>
            {{activity.customer}}
        </p>
    </div>
    <div class="col-3">
        <b>
            Indirizzo
        </b>
        <p>
            {{activity.address}}
        </p>
    </div>
    <div class="col-2">
        <b>
            Tipologia
        </b>
        <p>
            {{activity.type}}
        </p>
    </div>
    <div *ngIf="activity.expirationDate" class="col-2">
        <b>
            Scadenza
        </b>
        <p>
            {{activity.expirationDate | date:'dd/MM/yyyy'}}
        </p>
    </div>
    <div class="col-2">
        <b>
            Allegato
        </b>
        <p>
            <a [href]="CreateUrl()" target="_blank" >{{ activity.attachmentDisplayName }}</a>
        </p>
    </div>
    <div class="col-10">
        <b>
            Note
        </b>
        <div [innerHTML]="activity.description"></div>
    </div>
</div>

<kendo-tabstrip>
    <kendo-tabstrip-tab [selected]="true">
        <ng-template kendoTabTitle>
            <strong>Prodotti</strong>
        </ng-template>
        <ng-template kendoTabContent>
            <div class="row">
                <div class="col-12 d-flex gap-1">
                    <a class="btn btn-primary btn-sm" (click)="createActivityProduct()">
                        <span class="fa fa-plus"></span>
                        Associa prodotto
                    </a>
                    <a class="btn btn-primary btn-sm" (click)="assignAllCustomerProducts()">
                        <span class="fa fa-plus"></span>
                        Associa tutti i prodotti dell'indirizzo del cliente
                    </a>
                </div>
                <p></p>
            </div>
            <app-activity-products #activityProducts [activityId]="activity.id"></app-activity-products>
        </ng-template>
    </kendo-tabstrip-tab>
    <kendo-tabstrip-tab>
        <ng-template kendoTabTitle>
            <strong>Pianificazione</strong>
        </ng-template>
        <ng-template kendoTabContent>
            <div class="row">
                <div class="col-12 d-flex gap-1">
                    <a class="btn btn-primary btn-sm" (click)="createIntervention()">
                        <span class="fa fa-calendar-plus"></span>
                        Programma intervento
                    </a>
                </div>
                <p></p>
            </div>
            <app-interventions-calendar #interventionsCalendar [interventionModal]="interventionModal"
                [jobId]="activity.jobId" [activityId]="activity.id" (interventionUpdated)="onInterventionsChanged()"
                (interventionCreated)="onInterventionsChanged()" (interventionRemoved)="onInterventionsChanged()">
            </app-interventions-calendar>
        </ng-template>
    </kendo-tabstrip-tab>
    <kendo-tabstrip-tab>
        <ng-template kendoTabTitle>
            <strong>Interventi</strong>
        </ng-template>
        <ng-template kendoTabContent>
            <div class="row">
                <div class="col-12 d-flex gap-1">
                    <a class="btn btn-primary btn-sm" (click)="createIntervention()">
                        <span class="fa fa-calendar-plus"></span>
                        Programma intervento
                    </a>
                </div>
                <p></p>
            </div>
            <app-interventions-grid #interventionsGrid [interventionModal]="interventionModal"
                [activityId]="activity.id" (interventionUpdated)="onInterventionsChanged()"
                (interventionRemoved)="onInterventionsChanged()">
            </app-interventions-grid>
        </ng-template>
    </kendo-tabstrip-tab>
</kendo-tabstrip>

<app-activity-modal #activityModal></app-activity-modal>
<app-activity-product-modal #activityProductModal></app-activity-product-modal>
<app-intervention-modal #interventionModal></app-intervention-modal>